%x=[3777.25,3910.125,2687.125,2013.125,957.25,15.375,27.875,0.875];
%y=[199,199.2,167.2,149.9,123.2,99.7,99.8,99.6];
x=[346,     621,     922.875, 1116.375,1362.375,1415.25, 1721.25, 1998.5,  2168.625,2433.125,2659.25, 2908.75, 3101.375,3314.375,3542.5,  3878.25 ];
y=[107.89,  114.97,  122.41,  127.3,   133.26,  134.67,  142.28,  150.59,  154.69,  160.57,  166.28,  173.01,  177.95,  183.6,   190.35,  198.51  ];
z=polyfit(x,y,1)
zz=polyval(z,x)
zzz= zz-y

plot(x,y,'r')
hold on
plot(x,zz,'g')
figure
plot(x,zzz,'b')

x1=100:1:200;
y1=(x1/3400-100/3400)*36*4096;

for k=100:200
    z1=(k/(3300+k)-100/3400)*36*4096
end
zz1=z1-y1;
figure
plot(x1,zz1,'r')